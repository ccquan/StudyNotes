# MySQL

### 数据库操作

#### 查看数据库

- 查看当前的所以的数据库

    ```mysql
    show databases;
    ```

- 查看数据库创建时的属性

  ```mysql
  show create 数据库名;
  ```

#### 创建数据库

```mysql
create database[if not exists ]mytest[character set utf8mb4];
```

#### 删除数据库

```mysql
drop database mytest;
```

#### 修改数据库属性

```mysql
alter database mytest character set gdk;
```



### 表操作

#### 查看表

- 查看表的结构

    ```mysql
    desc 表名;
    show columns from 表名;
    ```



#### 创建表

```mysql
CREATE TABLE table_name (列名 数据类型);
```

- 实列1：创建tb_student表，里面包含id，name，sex，age列

```mysql
create table tb_student(id int unsigned, name varchar(20), sex varchar(2), age int unsigned[COMMENT  年龄']);
```



#### 修改表属性

```mysql
alter table tb_student modify name varchar(15);
```


- 实例1：将tb_grade表修改成tb_mark

  ```mysql
  alter table tb_grade rename to tb_mark;
  ```



#### 插入数据

```mysql
insert into tb_student(id, name, sex, age) values(1920501, '小明', '男', 18);
```

#### 删除数据

```mysql
delete from tb_studnet[where name='小明'];
```

#### 更新数据

```mysql
update tb_studnet name='小红',age=19 where id=1920501;
```

#### 查询数据

```mysql
select * from tb_student[where id<1920601];
```



### 用户管理

#### 查看所有用户

```mysql
SELECT DISTINCT CONCAT('User: ''',user,'''@''',host,''';') AS query FROM mysql.user;
```

#### 创建用户

```mysql
create user 'CJQ'@'localhost' identified by 'toor';
```

#### 删除用户

```mysql
drop user 'CJQ'@'localhost';
```

#### 修改用户

- 修改用户名称

  ```mysql
  rename user 'CJQ'@'localhost' to 'CJQ1'@'localhost';
  ```

- 修改用户密码

  ```mysql
  set password for root@localhost = password('root');
  ```

#### 授权

```sql
show grants for root@localhost;  # 查看权限
# 给予权限
grant select, insert on tb_student to 'test1'@'localhost';
# 收回权限
revoke insert on tb_student from 'test1'@'localhost';
```

权限列表：

- all privileges：所有权限。
- select：读取权限。
- delete：删除权限。
- update：更新权限。
- create：创建权限。
- drop：删除数据库、数据表权限。

授权内容：

- dbName.*;               授予dbName数据库所有表的权限

- dbName.dbTable;   授予数据库dbName中dbTable表的权限。

### 数值类型

- 整型

  TINY INT, SMALL INT, MEDIUM INT, INT, BIG INT

- 浮点型

  FLOAT, DOUBLE

- 字符串型

  CHAR:固定长度字符串

  VARCHAR:可变长度字符串

  BINARY:无字符集的字符串

  VARBINARY:同上，可变

  BLOB/TEXT:已对象类型保存，足够大的数据

  ENUM:枚举

  SET:集合

- 日期与时间型

  DAY

  DAY_HOUR： 日期:小时

  DAY_MINUTE：日期:小时:分钟

  DAY_SECOND：日期:小时:分钟:秒

  HOUR：小时

  HOUR_MINUTE：小时:分钟

  HOUR_SECOND：小时:分钟:秒



### 常用约束

| 名称                       | 说明                                                         |
| -------------------------- | ------------------------------------------------------------ |
| PRIMARY KEY  (/ˈpraɪmeri/) | 主键（唯一不可空），一个表只能有一个                         |
| FOREIGN KEY  (/ˈfɔːrən/)   | 外键 FOREIGN KEY(这个表的外键列) REFERENCES 另一个表(列一个表的列) |
| NOT NULL                   | 非空                                                         |
| DEFAULT '男'               | 默认值                                                       |
| UNIQUE                     | 唯一但可空，一个表可以用多个                                 |
| COMMENT                    | 备注                                                         |



### 案列

#### 创建dept、emp表

  ```mysql
create table dept(
    deptno char(4) COMMENT '部门编号',
    dname varchar(30) COMMENT '部门名称',
    dmanager varchar(10) COMMENT '部门经理',
    tel varchar(20) COMMENT '电话号码',
    PRIMARY KEY(deptno),
    NOT NULL(dname)
);

create table emp(
    id int COMMENT '员工编号' PRIMARY KEY,
    ename varchar(10) COMMENT '员工姓名' NOT NULL,
    hiredate date COMMENT '入职日期',
    esex char(2) DEFAULT '男' COMMENT '姓名',
    sal int COMMENT '工资',
    job varchar(30) COMMENT '工种' DEFAULT '程序员' NOT NULL,
    deptno char(4) COMMENT '部门编号',
    FOREIGN KEY(deptno) REFERENCES dept(deptno)
);
  ```

